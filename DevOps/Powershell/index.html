<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>PowerShell Notes - KaiDocs</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "PowerShell Notes", url: "#_top", children: [
              {title: "\u5e38\u7528cmdlet", url: "#cmdlet" },
              {title: "\u5e38\u7528\u6307\u4ee4", url: "#_1" },
              {title: "\u6e05\u9664\u756b\u9762(\u8b8a\u6578\u9084\u6703\u5b58\u5728)", url: "#_2" },
              {title: "\u958b\u555f\u6307\u4ee4\u76ee\u9304", url: "#_3" },
              {title: "Prompt\u547c\u53ebscript:Invoke-Expression", url: "#promptscriptinvoke-expression" },
              {title: "\u50b3\u905eParameter", url: "#parameter" },
              {title: "\u9060\u7aefPS", url: "#ps" },
              {title: "\u7121\u8cc7\u6599\u593e\u5247\u5efa\u7acb", url: "#_4" },
              {title: "WindowsService", url: "#windowsservice" },
              {title: "\u5b57\u4e32Slpit, Trim", url: "#slpit-trim" },
              {title: "\u8b80\u6a94", url: "#_5" },
              {title: "Get Assembly Version", url: "#get-assembly-version" },
              {title: "\u66ab\u505c", url: "#_6" },
              {title: "\u986f\u793a\u901a\u8a0a\u5354\u5b9a\u7d71\u8a08\u8cc7\u6599", url: "#_7" },
              {title: "DNS", url: "#dns" },
              {title: "How to debug ps1", url: "#how-to-debug-ps1" },
              {title: "\u78ba\u8a8d\u5ba2\u6236\u7d66\u7684\u5e33\u5bc6\u662f\u5426\u6b63\u78ba", url: "#_8" },
              {title: "Exit code", url: "#exit-code" },
              {title: "Environment Variables in PowerShell", url: "#environment-variables-in-powershell" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Shell/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Shell/" class="btn btn-xs btn-link">
        Shell
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Linux/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Linux/" class="btn btn-xs btn-link">
        Ubuntu
      </a>
    </div>
    
  </div>

    

    <h1 id="powershell-notes">PowerShell Notes</h1>
<h2 id="cmdlet">常用cmdlet</h2>
<p>確認版本</p>
<pre><code class="powershell">Get-Host
</code></pre>

<p>取得時間</p>
<pre><code class="powershell">Get-Date -Format yyyyMMdd

# 定義來源與目的資料夾的絕對路徑
$srcfolder = 'C:\Program Files (x86)\Bridgewell'    #最新檔案的資料夾
$folderName = 'update' + (Get-Date -Format yyyyMMdd)
$tarfolder = 'C:\Users\Administrator\Desktop\' + $folderName   #目的資料夾
</code></pre>

<p>指令執行路徑</p>
<pre><code class="powershell">Split-Path $MyInvocation.MyCommand.Path
</code></pre>

<p>script路徑</p>
<pre><code class="powershell">$PSScriptRoot
</code></pre>

<h2 id="_1">常用指令</h2>
<h2 id="_2">清除畫面(變數還會存在)</h2>
<pre><code class="powershell">cls
</code></pre>

<h2 id="_3">開啟指令目錄</h2>
<pre><code class="powershell">start .
</code></pre>

<h2 id="promptscriptinvoke-expression">Prompt呼叫script:Invoke-Expression</h2>
<p>範例</p>
<pre><code class="powershell">Invoke-Expression c:\scripts\test.ps1
&amp; c:\scripts\test.ps1
</code></pre>

<h2 id="parameter">傳遞Parameter</h2>
<pre><code class="powershell">$args[0]
$args[1]
$args[2]
</code></pre>

<h2 id="ps">遠端PS</h2>
<pre><code class="powershell">Enter-PSSession Server01
Exit-PSSession
</code></pre>

<pre><code class="powershell">$secpasswd = ConvertTo-SecureString &quot;password&quot; -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential (&quot;user&quot;, $secpasswd)
Enter-PSSession -ComputerName n196 -Credential $mycreds
</code></pre>

<h2 id="_4">無資料夾則建立</h2>
<pre><code class="powershell">IF (!(Test-Path $FolderToCreate -PathType Container)) {
    New-Item -ItemType Directory -Force -Path $FolderToCreate
}
</code></pre>

<h2 id="windowsservice">WindowsService</h2>
<pre><code class="powershell">net start BWECDataUpdateWindowService
net stop BWECDataUpdateWindowService
</code></pre>

<h2 id="slpit-trim">字串Slpit, Trim</h2>
<pre><code class="powershell">$parts = $content -split '\n'
$parts[0]
$parts[1]
if ($parts[0].Trim() -eq '@Q@')
{
    'WTF'
}
</code></pre>

<h2 id="_5">讀檔</h2>
<pre><code class="powershell">$content = [IO.File]::ReadAllText(&quot;.\test.txt&quot;)
</code></pre>

<h2 id="get-assembly-version">Get Assembly Version</h2>
<pre><code class="powershell">function get-assembly-version() {
    param([string] $file)

    $version = [System.Reflection.AssemblyName]::GetAssemblyName($file).Version;

    #format the version and output it...
    $version
}
</code></pre>

<h2 id="_6">暫停</h2>
<pre><code class="powershell">pause
</code></pre>

<h2 id="_7">顯示通訊協定統計資料</h2>
<pre><code class="powershell">nbtstat
</code></pre>

<h2 id="dns">DNS</h2>
<pre><code class="powershell">nslookup
</code></pre>

<h2 id="how-to-debug-ps1">How to debug ps1</h2>
<p><code>Write-Host</code> == <code>printf</code></p>
<p>Join-Path
Select-String</p>
<h2 id="_8">確認客戶給的帳密是否正確</h2>
<pre><code class="powershell">runas /u:yourdomain\a_test_user notepad.exe
</code></pre>

<h2 id="exit-code">Exit code</h2>
<pre><code class="powershell">Exit 0
</code></pre>

<h2 id="environment-variables-in-powershell">Environment Variables in PowerShell</h2>
<pre><code class="powershell">$env:&lt;variable_name&gt;
</code></pre>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Shell/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Shell/" class="btn btn-xs btn-link">
        Shell
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Linux/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Linux/" class="btn btn-xs btn-link">
        Ubuntu
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>